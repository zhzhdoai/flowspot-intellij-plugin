package omni.flowspot.model;

/**
 * 漏洞严重程度枚举
 */
public enum VulnerabilitySeverity {
    CRITICAL("Critical", 4),
    HIGH("High", 3),
    MEDIUM("Medium", 2),
    LOW("Low", 1);
    
    private final String displayName;
    private final int level;
    
    VulnerabilitySeverity(String displayName, int level) {
        this.displayName = displayName;
        this.level = level;
    }
    
    public String getDisplayName() {
        return displayName;
    }
    
    public int getLevel() {
        return level;
    }
    
    /**
     * 根据分数获取严重程度
     */
    public static VulnerabilitySeverity fromScore(int score) {
        if (score >= 8) {
            return CRITICAL;
        } else if (score >= 6) {
            return HIGH;
        } else if (score >= 4) {
            return MEDIUM;
        } else {
            return LOW;
        }
    }
    
    /**
     * 根据FindBugs优先级获取严重程度
     */
    public static VulnerabilitySeverity fromPriority(int priority) {
        switch (priority) {
            case 1:
                return CRITICAL;
            case 2:
                return HIGH;
            case 3:
                return MEDIUM;
            default:
                return LOW;
        }
    }
}
