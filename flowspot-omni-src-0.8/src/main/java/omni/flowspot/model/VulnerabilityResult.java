package omni.flowspot.model;

import java.util.ArrayList;
import java.util.List;

/**
 * 漏洞扫描结果类，用于替代FindBugs的BugCollection
 */
public class VulnerabilityResult {
    
    private String projectName;
    private String projectPath;
    private List<VulnerabilityInstance> vulnerabilities;
    private ScanStatistics statistics;
    
    public VulnerabilityResult() {
        this.vulnerabilities = new ArrayList<>();
        this.statistics = new ScanStatistics();
    }
    
    public VulnerabilityResult(String projectName, String projectPath) {
        this.projectName = projectName;
        this.projectPath = projectPath;
        this.vulnerabilities = new ArrayList<>();
        this.statistics = new ScanStatistics();
    }
    
    // Getters and Setters
    public String getProjectName() {
        return projectName;
    }
    
    public void setProjectName(String projectName) {
        this.projectName = projectName;
    }
    
    public String getProjectPath() {
        return projectPath;
    }
    
    public void setProjectPath(String projectPath) {
        this.projectPath = projectPath;
    }
    
    public List<VulnerabilityInstance> getVulnerabilities() {
        return vulnerabilities;
    }
    
    public void setVulnerabilities(List<VulnerabilityInstance> vulnerabilities) {
        this.vulnerabilities = vulnerabilities;
    }
    
    public ScanStatistics getStatistics() {
        return statistics;
    }
    
    public void setStatistics(ScanStatistics statistics) {
        this.statistics = statistics;
    }
    
    // 便利方法
    public void addVulnerability(VulnerabilityInstance vulnerability) {
        this.vulnerabilities.add(vulnerability);
        this.statistics.incrementCount(vulnerability.getSeverity());
    }
    
    public int getTotalCount() {
        return vulnerabilities.size();
    }
    
    public int getCriticalCount() {
        return statistics.getCriticalCount();
    }
    
    public int getHighCount() {
        return statistics.getHighCount();
    }
    
    public int getMediumCount() {
        return statistics.getMediumCount();
    }
    
    public int getLowCount() {
        return statistics.getLowCount();
    }
    
    /**
     * 漏洞统计信息
     */
    public static class ScanStatistics {
        private int criticalCount = 0;
        private int highCount = 0;
        private int mediumCount = 0;
        private int lowCount = 0;
        
        public void incrementCount(VulnerabilitySeverity severity) {
            switch (severity) {
                case CRITICAL:
                    criticalCount++;
                    break;
                case HIGH:
                    highCount++;
                    break;
                case MEDIUM:
                    mediumCount++;
                    break;
                case LOW:
                    lowCount++;
                    break;
            }
        }
        
        // Getters
        public int getCriticalCount() { return criticalCount; }
        public int getHighCount() { return highCount; }
        public int getMediumCount() { return mediumCount; }
        public int getLowCount() { return lowCount; }
        public int getTotalCount() { return criticalCount + highCount + mediumCount + lowCount; }
        
        // Setters
        public void setCriticalCount(int criticalCount) { this.criticalCount = criticalCount; }
        public void setHighCount(int highCount) { this.highCount = highCount; }
        public void setMediumCount(int mediumCount) { this.mediumCount = mediumCount; }
        public void setLowCount(int lowCount) { this.lowCount = lowCount; }
    }
}
