package omni.flowspot.model;

import java.util.ArrayList;
import java.util.List;

/**
 * 单个漏洞实例，用于替代FindBugs的BugInstance
 */
public class VulnerabilityInstance {
    
    private String id;
    private String name;
    private String description;
    private VulnerabilitySeverity severity;
    private String category;
    private String pattern;
    private List<VulnerabilityLocation> locations;
    private String sourceMethod;
    private String sinkMethod;
    private int score;
    
    public VulnerabilityInstance() {
        this.locations = new ArrayList<>();
    }
    
    public VulnerabilityInstance(String name, VulnerabilitySeverity severity) {
        this.name = name;
        this.severity = severity;
        this.locations = new ArrayList<>();
    }
    
    // Getters and Setters
    public String getId() {
        return id;
    }
    
    public void setId(String id) {
        this.id = id;
    }
    
    public String getName() {
        return name;
    }
    
    public void setName(String name) {
        this.name = name;
    }
    
    public String getDescription() {
        return description;
    }
    
    public void setDescription(String description) {
        this.description = description;
    }
    
    public VulnerabilitySeverity getSeverity() {
        return severity;
    }
    
    public void setSeverity(VulnerabilitySeverity severity) {
        this.severity = severity;
    }
    
    public String getCategory() {
        return category;
    }
    
    public void setCategory(String category) {
        this.category = category;
    }
    
    public String getPattern() {
        return pattern;
    }
    
    public void setPattern(String pattern) {
        this.pattern = pattern;
    }
    
    public List<VulnerabilityLocation> getLocations() {
        return locations;
    }
    
    public void setLocations(List<VulnerabilityLocation> locations) {
        this.locations = locations;
    }
    
    public String getSourceMethod() {
        return sourceMethod;
    }
    
    public void setSourceMethod(String sourceMethod) {
        this.sourceMethod = sourceMethod;
    }
    
    public String getSinkMethod() {
        return sinkMethod;
    }
    
    public void setSinkMethod(String sinkMethod) {
        this.sinkMethod = sinkMethod;
    }
    
    public int getScore() {
        return score;
    }
    
    public void setScore(int score) {
        this.score = score;
    }
    
    // 便利方法
    public void addLocation(VulnerabilityLocation location) {
        this.locations.add(location);
    }
    
    /**
     * 根据分数确定严重程度
     */
    public static VulnerabilitySeverity getSeverityFromScore(int score) {
        if (score >= 8) {
            return VulnerabilitySeverity.CRITICAL;
        } else if (score >= 6) {
            return VulnerabilitySeverity.HIGH;
        } else if (score >= 4) {
            return VulnerabilitySeverity.MEDIUM;
        } else {
            return VulnerabilitySeverity.LOW;
        }
    }
}
